<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>ì—¬í–‰ì—…ê³ íŠ€ì–´</title>
</head>
<style>

    body {
        font-family: 'Arial', sans-serif;
        margin: 0;
        padding: 0;

    }
    header {
             display: flex;
             justify-content: space-between;
             align-items: center;
             padding: 10px 20px;
             background-color: #fff;
             border-bottom: 1px solid #ccc;
            }

     .profile-icon img {
                width: 40px;
                height: 40px;
                border-radius: 50%;

            }


      .search-bar-container {
        display: flex;
        justify-content: center;
        align-items: center;
        margin: 20px 0;

    }

    nav ul {
        display: flex;
        justify-content: center;
        align-items: center;
        margin: 20px 0;
        list-style-type: none;
    }

    nav li {
        margin-left: 50px;
        margin-right: 50px;
        text-align: center; /* í…ìŠ¤íŠ¸ ì¤‘ì•™ ì •ë ¬ */
    }

    .navImg {
        width: 32px;
        height: 32px;
        display: block; /* blockìœ¼ë¡œ ì„¤ì •í•˜ì—¬ ì¤‘ì•™ ì •ë ¬ ê°€ëŠ¥ */
        margin: 0 auto; /* ìë™ ë§ˆì§„ìœ¼ë¡œ ê°€ìš´ë° ì •ë ¬ */
    }

    /* ê²€ìƒ‰ë°” ìŠ¤íƒ€ì¼ */
    .search-bar {
        display: flex;
        background-color: #ffffff;
        width : 400px;
        border: 1px solid #ccc;
        border-radius: 50px;
        padding: 10px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .search-bar select, .search-bar input {
        border: none;
        padding: 10px;
        margin-right: 10px;
        border-radius: 30px;
        background-color: white;
        outline: none;
    }


    .search-bar input {
        width: 350px;
    }

    .search-bar button {
        background-color: #B2D055;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 50px;
        cursor: pointer;
    }

    .search-bar button:hover {
        background-color: #45a049;
    }
    main {
        padding: 20px;
    }

    .featured-image {
        text-align: center;
    }

    .featured-image img {
        width: 700px;
        height: 400px;


    }

    .gallery-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); /* ì¹´ë“œê°€ ìµœì†Œ 300pxì”© ê³µê°„ì„ ì°¨ì§€í•˜ë©´ì„œ ë‚˜ì—´ë˜ê²Œ í•¨ */
        gap: 20px; /* ì¹´ë“œë“¤ ê°„ì˜ ê°„ê²©ì„ 20pxë¡œ ì„¤ì • */
        align-items: start; /* ì¹´ë“œë“¤ì´ ìœ„ìª½ìœ¼ë¡œ ì •ë ¬ë˜ê²Œ ë§Œë“¦ */
    }

    .gallery-grid div {
        display: flex;
        flex-direction: column; /* ì´ë¯¸ì§€ë¥¼ ìœ„, í…ìŠ¤íŠ¸ë¥¼ ì•„ë˜ë¡œ ë°°ì¹˜ */
        align-items: center;
        background-color: #fff; /* ì¹´ë“œ ë°°ê²½ìƒ‰ */
        border-radius: 15px; /* ë‘¥ê·¼ ëª¨ì„œë¦¬ */
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* ê·¸ë¦¼ì íš¨ê³¼ */
        overflow: hidden; /* ë‚´ìš©ì´ ë°•ìŠ¤ ë°–ìœ¼ë¡œ ë„˜ì¹˜ì§€ ì•Šë„ë¡ */
        transition: transform 0.3s ease; /* ì¹´ë“œì— ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë ¸ì„ ë•Œì˜ ì• ë‹ˆë©”ì´ì…˜ */
        position: relative;
    }

    .gallery-grid div:hover {
        transform: translateY(-10px); /* ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë¦¬ë©´ ì‚´ì§ ìœ„ë¡œ ì´ë™ */
    }

    .gallery-grid img {
        width: 100%; /* ì¹´ë“œì˜ ë„ˆë¹„ë¥¼ ê°€ë“ ì±„ìš°ë„ë¡ */
        height: 200px; /* ì´ë¯¸ì§€ ë†’ì´ë¥¼ ê³ ì • */
        object-fit: cover; /* ì´ë¯¸ì§€ê°€ ì°Œê·¸ëŸ¬ì§€ì§€ ì•Šê³  ì ì ˆí•˜ê²Œ ìë¥´ê¸° */
        border-bottom: 1px solid white; /* ì´ë¯¸ì§€ ì•„ë˜ìª½ì— êµ¬ë¶„ì„ ì„ ì¶”ê°€ */
    }

    .gallery-grid p {
        margin: 5px 0; /* ì¤„ ê°„ê²©ì„ ì¤„ì´ê¸° ìœ„í•´ ë§ˆì§„ì„ ì¤„ì„ */
        font-size: 14px;
        color: #333;
        text-align: left;
        width: 90%;
        line-height: 1.2; /* ì¤„ ê°„ê²©ì„ ì¤„ì„ */
        display: flex; /* í‰ì ê³¼ ê°€ê²©ì„ ì •ë ¬í•˜ê¸° ìœ„í•´ í”Œë ‰ìŠ¤ë°•ìŠ¤ ì‚¬ìš© */
        justify-content: space-between; /* ì¢Œìš°ë¡œ ì•„ì´í…œë“¤ì„ ë°°ì¹˜ */
    }

    .gallery-grid span.stars {
        color: #B2D055;
        font-size: 16px;
        margin-right: 10px; /* í‰ì ì„ ì¢€ ë” ì˜¤ë¥¸ìª½ìœ¼ë¡œ ì´ë™ */
    }

    .gallery-grid p span {
        margin-right: 10px; /* ì´ë¦„ê³¼ í‰ì  ì‚¬ì´ì˜ ê°„ê²© ì¡°ì ˆ */
    }

    .wishlist-btn {
        position: absolute;
        bottom: 5px; /* í•˜ë‹¨ì—ì„œ 10px ìœ„ë¡œ */
        right: 10px; /* ì˜¤ë¥¸ìª½ì—ì„œ 10px ì™¼ìª½ìœ¼ë¡œ */
        background-color: transparent;
        border: none;
        cursor: pointer;
        outline: none;

    }

     .wishlist-btn img {
        width: 22px;
        height: 22px;
        transition: transform 0.3s ease;
        outline: none;
    }

    .wishlist-btn img:hover {
        transform: scale(1.1); /* ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë ¸ì„ ë•Œ ì•„ì´ì½˜ì´ ì»¤ì§€ëŠ” íš¨ê³¼ */
    }

    .price {
        text-align: left;
        width: 90%; /* ê°€ê²© í…ìŠ¤íŠ¸ë¥¼ ì™¼ìª½ì— ë¶™ì„ */
        font-size: 16px;
        color: #000;
        margin-top: 5px;
    }

     #searchButton{
           width:20px;
           height:20px;
        }
     .stars {
            color: #B2D055;
            font-size: 18px;
        }



</style>

<body>
<div>
<th:block th:replace="~{fragments/header :: headerFragment}"></th:block>
    <div class="search-bar-container">
        <form class="search-bar" action="/search" method="get">
            <input type="text" name="search" value="" placeholder="ê²€ìƒ‰í•  ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”." required/>

            <button type="submit">
                <img id="searchButton" src="../images/search-button.png">
            </button>

        </form>
    </div>
</div>

<nav>
    <ul>
        <li>
            <a href="/nav?accType=í˜¸í…”"><img class="navImg" src="../images/hotel.png"></a><br>
            í˜¸í…”
        </li>
        <li>
            <a href="/nav?accType=ê²ŒìŠ¤íŠ¸í•˜ìš°ìŠ¤"><img class="navImg" src="../images/guestHouse.png"></a><br>
            ê²ŒìŠ¤íŠ¸í•˜ìš°ìŠ¤
        </li>
        <li>
            <a href="/nav?accType=íœì…˜"><img class="navImg" src="../images/pension.png"></a><br>
            íœì…˜
        </li>
        <li>
            <a href="/nav?accType=í’€ë¹Œë¼"><img class="navImg" src="../images/poolVilla.png"></a><br>
            í’€ë¹Œë¼
        </li>
        <li>
            <a href="/nav?accType=ìº í•‘ì¥"><img class="navImg" src="../images/camping.png"></a><br>
            ìº í•‘ì¥
        </li>
    </ul>
</nav>




<main>

    <section class="featured-image">
        <img class="slideImg" src="../images/up.jpg" alt="íŠ¹ë³„í•œ ì—¬í–‰">
        <p>ğŸŒŠ <strong>ì—¬í–‰ì˜ ì¦ê±°ì›€</strong> ğŸŒŠ</p>
    </section>

    <section class="gallery">
        <h2>ìº í•‘ ê°€ê¸° ì¢‹ì€ ê°€ì„</h2>
        <div class="gallery-grid">
            <div class="galler-gridList" th:each="side : ${countryside}">
                <img src="../images/up.jpg">
                <input type="hidden" class="accomNumName" name="accomNum" th:value="${side.accomNum}">
                <p>
                    <span>[[${side.accName}]]</span>
                    <span th:if="${side.satisAvg != 0}">
                        <span class="stars">â˜… [[${side.satisAvg}]]</span>
                    </span>
                </p>
                <p>[[${side.address}]]</p><br>
                <p class="price">â‚©[[${side.price}]] /ë°•</p>
                <button class="wishlist-btn">
                    <img src="../images/EmptyLove.png" alt="ìœ„ì‹œë¦¬ìŠ¤íŠ¸ í•˜íŠ¸">
                    <input type="hidden" class="accomNum" name="accomNum" th:value="${side.accomNum}">
                </button>
            </div>
        </div>
    </section>

    <section class="gallery">
        <h2>ì•„ê²½ì„ ë³´ê³  ì‹¶ìœ¼ì‹œë‹¤ë©´?</h2>
        <div class="gallery-grid">
            <div class="galler-gridList" th:each="city : ${city}">
                <img src="../images/hotel.jpg">
                <input type="hidden" class="accomNumName" name="accomNum" th:value="${city.accomNum}">
                <p>
                    <span>[[${city.accName}]]</span>
                    <span th:if="${city.satisAvg != 0}">
                     <span class="stars">â˜… [[${city.satisAvg}]]</span>
                    </span>
                </p>
                <p>[[${city.address}]]</p><br>
                <p class="price">â‚©[[${city.price}]] /ë°•</p>
                <button class="wishlist-btn">
                    <img src="../images/EmptyLove.png" alt="ìœ„ì‹œë¦¬ìŠ¤íŠ¸ í•˜íŠ¸">
                    <input type="hidden" class="accomNum" name="accomNum" th:value="${city.accomNum}">
                </button>
            </div>
        </div>
    </section>

    <section class="gallery">
        <h2>ì´ë²ˆ ì˜¤ì…˜ë·°ëŠ” ì–´ë””ë¡œ?</h2>
        <div class="gallery-grid">
            <div class="galler-gridList" th:each="ocean : ${ocean}">
                <img src="../images/ocean.jpg">
                <input type="hidden" class="accomNumName" name="accomNum" th:value="${ocean.accomNum}">
                <p>
                    <span>[[${ocean.accName}]]</span>
                    <span th:if="${ocean.satisAvg != 0}">
                     <span class="stars">â˜… [[${ocean.satisAvg}]]</span>
                    </span>
                </p>
                <p>[[${ocean.address}]]</p><br>
                <p class="price">â‚©[[${ocean.price}]] /ë°•</p>
                <button class="wishlist-btn">
                    <img src="../images/EmptyLove.png" alt="ìœ„ì‹œë¦¬ìŠ¤íŠ¸ í•˜íŠ¸">
                    <input type="hidden" class="accomNum" name="accomNum" th:value="${ocean.accomNum}">
                </button>
            </div>
        </div>
    </section>
</main>

<div>
    <th:block th:replace="~{fragments/footer :: footerFragment}"></th:block>
</div>
<script>

    window.onload = function(){

        let imgBtn = document.getElementsByClassName("wishlist-btn");

        let clickAccomNum;
        let checkStatus;
        let xhrList = new XMLHttpRequest();
        xhrList.onload = function() {
            if(xhrList.status == 200){
                let obj = xhrList.responseText;
                let jsonObj = JSON.parse(obj);

             for (let i = 0; i < imgBtn.length; i++) {
                    let accomNum = imgBtn[i].querySelector('.accomNum').value;
                    let isWished = jsonObj.some(item => item.accomNum == accomNum);


                    if (isWished) {
                        imgBtn[i].querySelector('img').src = "../images/FullLove.png"; // ì´ë¯¸ ìœ„ì‹œë¦¬ìŠ¤íŠ¸ì— ìˆëŠ” ì•„ì´í…œ
                    }
                }
            }
        }
        xhrList.open('GET','/wishCheck',true);
        xhrList.send();




        for(let i = 0; i<imgBtn.length;i++){
            imgBtn[i].onclick = function(e){
                 clickAccomNum = imgBtn[i].querySelector('.accomNum').value;
                 e.stopPropagation();
                 let xhrCheck = new XMLHttpRequest();
                 xhrCheck.open('GET', `/checkWish/${clickAccomNum}`, true);
                 xhrCheck.onload = function() {

                 if (xhrCheck.status == 200) {
                     const isWished = JSON.parse(xhrCheck.responseText);
                     let xhr = new XMLHttpRequest();
                     if (isWished) {
                         xhr.open('GET',`/delete/${clickAccomNum}`,true);
                         xhr.send();
                       imgBtn[i].querySelector('img').src = "../images/EmptyLove.png";

                    } else {

                        let data ={
                            id : 'testID',
                            accomNum : clickAccomNum,
                            checkStatus : 1
                       };

                       xhr.open('POST','/wish',true);
                       xhr.setRequestHeader("Content-Type", "application/json; charset=utf-8");
                       xhr.send(JSON.stringify(data));

                        imgBtn[i].querySelector('img').src = "../images/FullLove.png";

                        }
                    }
                  };
                xhrCheck.send();
            }; // onclick
        } // for



       let postList =  document.getElementsByClassName("galler-gridList");

        for(let i=0;i<postList.length;i++){
               postList[i].onclick = function(){
                 let postNum = postList[i].querySelector('.accomNumName').value;
                    window.location.href="/accDetail?accomNum="+postNum;
               }
        }



    } // window

</script>
</body>
</html>